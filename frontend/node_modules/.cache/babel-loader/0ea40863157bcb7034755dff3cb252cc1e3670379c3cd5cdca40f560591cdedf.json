{"ast":null,"code":"// Funciones de autenticación y manejo de sesiones\nexport const authenticateUser=(email,password,users)=>{const user=users.find(u=>u.email===email&&u.password===password);if(user){// En una aplicación real, aquí generaríamos un token JWT\nreturn{success:true,user:{id:user.id,name:user.name,email:user.email,role:user.role,accountId:user.accountId,teamId:user.teamId,avatar:user.avatar,ci:user.ci// Incluir CI en el user object\n}};}return{success:false,message:\"Credenciales inválidas\"};};export const checkUserPermission=(user,requiredRole)=>{if(!user)return false;// Roles en orden jerárquico\nconst roles=[\"member\",\"supervisor\",\"admin\"];const userRoleIndex=roles.indexOf(user.role);const requiredRoleIndex=roles.indexOf(requiredRole);// El user tiene el rol requerido o un rol superior\nreturn userRoleIndex>=requiredRoleIndex;};export const getUserTeamMembers=(user,users,teams)=>{if(!user||!Array.isArray(users)||!Array.isArray(teams))return[];// Si es supervisor, obtener miembros de su equipo\nif(user.role===\"supervisor\"){return users.filter(u=>u.teamId===user.teamId&&u.id!==user.id);}// Si es admin, obtener todos los users que no sean el admin actual\nif(user.role===\"admin\"){return users.filter(u=>u.id!==user.id);}return[];};// DONE","map":{"version":3,"names":["authenticateUser","email","password","users","user","find","u","success","id","name","role","accountId","teamId","avatar","ci","message","checkUserPermission","requiredRole","roles","userRoleIndex","indexOf","requiredRoleIndex","getUserTeamMembers","teams","Array","isArray","filter"],"sources":["C:/Contabia/frontend/src/utils/auth.js"],"sourcesContent":["// Funciones de autenticación y manejo de sesiones\n\nexport const authenticateUser = (email, password, users) => {\n  const user = users.find(u => u.email === email && u.password === password);\n  if (user) {\n    // En una aplicación real, aquí generaríamos un token JWT\n    return {\n      success: true,\n      user: {\n        id: user.id,\n        name: user.name,\n        email: user.email,\n        role: user.role,\n        accountId: user.accountId,\n        teamId: user.teamId,\n        avatar: user.avatar,\n        ci: user.ci // Incluir CI en el user object\n      }\n    };\n  }\n  return { success: false, message: \"Credenciales inválidas\" };\n};\n\nexport const checkUserPermission = (user, requiredRole) => {\n  if (!user) return false;\n  \n  // Roles en orden jerárquico\n  const roles = [\"member\", \"supervisor\", \"admin\"];\n  const userRoleIndex = roles.indexOf(user.role);\n  const requiredRoleIndex = roles.indexOf(requiredRole);\n  \n  // El user tiene el rol requerido o un rol superior\n  return userRoleIndex >= requiredRoleIndex;\n};\n\nexport const getUserTeamMembers = (user, users, teams) => {\n  if (!user || !Array.isArray(users) || !Array.isArray(teams)) return [];\n  \n  // Si es supervisor, obtener miembros de su equipo\n  if (user.role === \"supervisor\") {\n    return users.filter(u => u.teamId === user.teamId && u.id !== user.id);\n  }\n  \n  // Si es admin, obtener todos los users que no sean el admin actual\n  if (user.role === \"admin\") {\n    return users.filter(u => u.id !== user.id);\n  }\n  \n  return [];\n};\n// DONE"],"mappings":"AAAA;AAEA,MAAO,MAAM,CAAAA,gBAAgB,CAAGA,CAACC,KAAK,CAAEC,QAAQ,CAAEC,KAAK,GAAK,CAC1D,KAAM,CAAAC,IAAI,CAAGD,KAAK,CAACE,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACL,KAAK,GAAKA,KAAK,EAAIK,CAAC,CAACJ,QAAQ,GAAKA,QAAQ,CAAC,CAC1E,GAAIE,IAAI,CAAE,CACR;AACA,MAAO,CACLG,OAAO,CAAE,IAAI,CACbH,IAAI,CAAE,CACJI,EAAE,CAAEJ,IAAI,CAACI,EAAE,CACXC,IAAI,CAAEL,IAAI,CAACK,IAAI,CACfR,KAAK,CAAEG,IAAI,CAACH,KAAK,CACjBS,IAAI,CAAEN,IAAI,CAACM,IAAI,CACfC,SAAS,CAAEP,IAAI,CAACO,SAAS,CACzBC,MAAM,CAAER,IAAI,CAACQ,MAAM,CACnBC,MAAM,CAAET,IAAI,CAACS,MAAM,CACnBC,EAAE,CAAEV,IAAI,CAACU,EAAG;AACd,CACF,CAAC,CACH,CACA,MAAO,CAAEP,OAAO,CAAE,KAAK,CAAEQ,OAAO,CAAE,wBAAyB,CAAC,CAC9D,CAAC,CAED,MAAO,MAAM,CAAAC,mBAAmB,CAAGA,CAACZ,IAAI,CAAEa,YAAY,GAAK,CACzD,GAAI,CAACb,IAAI,CAAE,MAAO,MAAK,CAEvB;AACA,KAAM,CAAAc,KAAK,CAAG,CAAC,QAAQ,CAAE,YAAY,CAAE,OAAO,CAAC,CAC/C,KAAM,CAAAC,aAAa,CAAGD,KAAK,CAACE,OAAO,CAAChB,IAAI,CAACM,IAAI,CAAC,CAC9C,KAAM,CAAAW,iBAAiB,CAAGH,KAAK,CAACE,OAAO,CAACH,YAAY,CAAC,CAErD;AACA,MAAO,CAAAE,aAAa,EAAIE,iBAAiB,CAC3C,CAAC,CAED,MAAO,MAAM,CAAAC,kBAAkB,CAAGA,CAAClB,IAAI,CAAED,KAAK,CAAEoB,KAAK,GAAK,CACxD,GAAI,CAACnB,IAAI,EAAI,CAACoB,KAAK,CAACC,OAAO,CAACtB,KAAK,CAAC,EAAI,CAACqB,KAAK,CAACC,OAAO,CAACF,KAAK,CAAC,CAAE,MAAO,EAAE,CAEtE;AACA,GAAInB,IAAI,CAACM,IAAI,GAAK,YAAY,CAAE,CAC9B,MAAO,CAAAP,KAAK,CAACuB,MAAM,CAACpB,CAAC,EAAIA,CAAC,CAACM,MAAM,GAAKR,IAAI,CAACQ,MAAM,EAAIN,CAAC,CAACE,EAAE,GAAKJ,IAAI,CAACI,EAAE,CAAC,CACxE,CAEA;AACA,GAAIJ,IAAI,CAACM,IAAI,GAAK,OAAO,CAAE,CACzB,MAAO,CAAAP,KAAK,CAACuB,MAAM,CAACpB,CAAC,EAAIA,CAAC,CAACE,EAAE,GAAKJ,IAAI,CAACI,EAAE,CAAC,CAC5C,CAEA,MAAO,EAAE,CACX,CAAC,CACD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}